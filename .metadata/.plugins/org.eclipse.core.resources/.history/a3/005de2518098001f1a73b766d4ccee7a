/*
 * timer.c
 *
 *  Created on: 1 Nov 2024
 *      Author: farah
 */

#include"timer.h"
#include<avr/io.h>

void Timer_init(const Timer_ConfigType*Config_Ptr)
{
	if((Config_Ptr->timer_ID)==TIMER0)
	{
		if((Config_Ptr->timer_mode)==NORMAL)
		{
			TCCR0=((Config_Ptr->timer_clock)&0x07);
			TCNT0=Config_Ptr->timer_InitialValue;
			TIMSK|=(1<<TOIE0);
		}
		else if((Config_Ptr->timer_mode)==COMPARE_MATCH)
		{
		  TCCR0=(1<<FOC0)|(1<<WGM01)|(1<<COM01)|((Config_Ptr->timer_clock)&0x07);
		  TCNT0=Config_Ptr->timer_InitialValue;
		  OCR0=Config_Ptr ->timer_compare_MatchValue;
		  TIMSK|=(1<<OCIE0);
		}
	}

	else if((Config_Ptr->timer_ID)==TIMER1)
	{
		 if((Config_Ptr->timer_mode)==NORMAL)
		 {
			 TCCR1A=0;
			 TCCR1B=((Config_Ptr->timer_clock)&0x07);
			 TIMSK=(1<<TOIE1);
		 }
		 else if((Config_Ptr->timer_mode)==COMPARE_MATCH)
		 {
			 TCCR1B=(1<<WGM12)|((Config_Ptr->timer_clock)&0x07);
			 OCR1A=(Config_Ptr->timer_compare_MatchValue);
			 TIMSK=(1<<OCIE1A);

			 #ifdef INVERTING_CTC_MODE
			 TCCR1A=(1<<COM1A1)|(1<<FOC1A);
             #endif
             #ifdef NONIVERTING_MODE
			 TCCR1A=(1<<COM1A1)|(1<<COM1A0)|(1<<FOC1A);
             #endif

		 }

	}
}
void Timer_deInit(Timer_ID_Type timer_type)
{
	if(timer_type==TIMER0)
	{
		TCCR0&=0xF8;
	}
	else if(timer_type==TIMER1)
	{
		TCCR1B&=0xF8; /*CLOCK=0*/
	}
}
void Timer_setCallBack(void(*a_ptr)(void),Timer_ID_Type a_timer_ID)
{

}
